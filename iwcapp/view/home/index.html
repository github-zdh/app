<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>首页</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../../css/mui.min.css">
		<link rel="stylesheet" href="../../model/index.css">
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			.title {
				padding: 20px 15px 10px;
				color: #6d6d72;
				font-size: 15px;
				background-color: #fff;
			}
			#pullrefresh{overflow-y: scroll;}
			/*-------------------*/
             .homeList ul li a{position: relative;display: block;background: #fff;}
             .homeList ul li a{border-bottom: 1px solid #e1e1e1;}
             .homeList ul li a .userImg,.homeList ul li a .time{width: 44px;height: 44px;overflow: hidden;position: absolute;top:7px;left:10px;border-radius: 3px;}
             .homeList ul li a .msg{position:absolute;top:3px;left:54px;z-index:1000;font-size: 10px;color:#fff;}
             .homeList ul li a .msg .mui-badge{line-height: 1;padding-top:3px;}
             .homeList ul li a .content{padding:7px 70px 7px 65px;}
             .homeList ul li a h1,.homeList ul li a p{overflow: hidden;text-overflow: ellipsis;white-space:nowrap;}
             .homeList ul li a h1{font-size: 16px;color:#333;line-height: 24px;}
             .homeList ul li a p,.homeList ul li a .time{font-size: 12px;color:#999;}
             .homeList ul li a div.time{width: 55px;right: 10px;left:auto;font-size:11px;text-align:right;}
             .homeList ul li a .time span{font-size: 24px;color:#ccc;}
		</style>
		
		<!--<script src="../../socket.io/socket.io.js"></script>
		<script type="text/javascript">
		   var about = io.connect('http://localhost:3000/about');  
		   console.log(about);
		   about.on('msg', function (data) {
		         console.log(data);
		   });
		   about.emit('about event', {"event":'this is my about event'});

		</script>-->
	</head>

	<body>
		<div id="room">
                <section class="homeList">
                      <ul id="create">
                      	   <li v-for="item in items">
                      	         <a data-wid="./chat.html" :data-view="'../chat/chat.html?room='+item.rid+'&uid='+item.uid">
                                       <div class="userImg">
                                              <img v-bind:src="item.userImg">
                                       </div>
                                       <div class="msg mui-icon">
                                         	<span class="mui-badge">{{item.badge}}</span>
                                       </div>
                                       <div class="content">
                                             <h1>{{item.title}}room={{item.rid}}&uid={{item.uid}}</h1>
                                             <p>{{item.stitle}}</p>
                                       </div>
                                       <div class="time">
                                             <div>{{item.time}}</div>
                                             <span class="mui-icon mui-icon-home" v-if="item.shield"></span>
                                       </div>
                      	         </a>
                      	   </li>
                      	   
                     </ul>
				 </section>	
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/mui.md5.js"></script>
		<script src="../../contronller/config.js"></script>
		<script src="../../contronller/common.js"></script>
		<script src="../../contronller/createView.js"></script>
		<script src="../../contronller/vue.js"></script>
		<style type="text/css">
			.mui-backdrop {position: fixed;top: 0;right: 0;bottom: 0;left: 0;z-index: 998;background-color: rgba(0,0,0,.3);}
		</style>
		<script>
			mui.init({
				swipeBack: false,
				keyEventBind: {
					backbutton: false //关闭back按键监听
				}
			});
//			console.log('config.userInfo.id----------------------------------'+config.userInfo.id);
//		    mui.ajax({
//			    	url:config.host+'/app/search/mail',
//			    	type:'post',
//			    	data:{
//			    		uid:config.userInfo.id
//			    	},
//			    	success:function(data){
//			    		mui.toast(data.msg);
//			    		console.log(JSON.stringify(data))								    		
//			    	},
//			    	error:function(err){
//			    		console.log(err);
//			    		mui.toast('连接服务器失败')
//			    	}
//		    })
//			var view = new plus.nativeObj.View(id, styles, tags);
		mui.plusReady(function() {
					//点击对应聊天显示聊天界面
					mui("body").on("tap", "a", function(e) {
		                   var _this = this;
		                   view.openWindow(_this);
					});					
					//引入vue
					new Vue({
                        el:"#room",
					    data:function(){
					    	 return {
					    	 	  items : [
					    	 	        {
					    	 	        	rid:1,
					    	 	        	uid:1,
					    	 	        	badge:1,//（数字角标）
					    	 	        	shield:true,//屏蔽
					    	 	        	time:'下午 15:30',
					    	 	        	title:'首页',
					    	 	        	stitle:'首页首页首页首页首页首页首页首页',
					    	 	        	userImg:'https://avatars2.githubusercontent.com/u/35329223?s=400&amp;u=68cabf242a4069835af3454d7d1cf09fb47b58d8&amp;v=4'
					    	 	        },
					    	 	        {
					    	 	        	rid:1,
					    	 	        	uid:2,
					    	 	        	badge:2,
					    	 	        	shield:false,
					    	 	        	time:'下午 15:30',
					    	 	        	title:'首页',
					    	 	        	stitle:'首页首页首页首页首页首页首页首页',
					    	 	        	userImg:'https://avatars2.githubusercontent.com/u/35329223?s=400&amp;u=68cabf242a4069835af3454d7d1cf09fb47b58d8&amp;v=4'
					    	 	        }
					    	 	  ]
					    	 }
					    },
					    beforeCreate:function(){
							    mui.ajax({
								    	url:config.host+'/app/search/mail',
								    	type:'post',
								    	data:{
								    		uid:config.userInfo.id
								    	},
								    	success:function(data){
								    		mui.toast(data.msg);
								    		console.log(JSON.stringify(data))								    		
								    	},
								    	error:function(err){
								    		console.log(err);
								    		mui.toast('连接服务器失败')
								    	}
							    })
					    }
					})
			  });
		</script>
		

	</body>
</html>